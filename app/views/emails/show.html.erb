<%# app/views/emails/show.html.erb %>
<% content_for :title, (@email.subject.presence || "Email") %>

<div class="min-h-screen bg-slate-50">
  <!-- full-width container (não centralizado) -->
  <div class="w-full">

    <!-- Header -->
    <header class="mb-6">
      <div class="flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4">
        <div class="min-w-0">
          <h3 class="text-sm font-medium text-slate-500 mb-1">Detalhes do e-mail</h3>
          <h1 class="text-2xl lg:text-3xl font-extrabold text-slate-900 leading-tight truncate">
            <%= @email.subject.presence || "(sem assunto)" %>
          </h1>

          <div class="mt-3 flex flex-wrap items-center gap-3 text-sm text-slate-600">
            <div class="inline-flex items-center gap-2">
              <span class="text-xs text-slate-400">De</span>
              <span class="font-medium text-slate-800"><%= @email.sender_name %> (<%= @email.from_email || "—" %>)</span>
            </div>

            <div class="inline-flex items-center gap-2">
              <span class="text-xs text-slate-400">Para</span>
              <span class="text-slate-700"><%= @email.recipient_name %> (<%= @email.to_email || "—" %>)</span>
            </div>

            <div class="inline-flex items-center gap-2">
              <span class="text-xs text-slate-400">Enviado</span>
              <time class="text-slate-600"><%= @email.timestamp.present? ? l(@email.timestamp, format: :short) : l(@email.created_at, format: :short) %></time>
            </div>

            <%# direction / status badges %>
            <div class="inline-flex items-center gap-2">
              <% if @email.email_direction.present? %>
                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold bg-slate-100 text-slate-700">
                  <%= @email.email_direction.upcase %>
                </span>
              <% end %>

              <% if @email.email_status.present? %>
                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold bg-slate-100 text-slate-700">
                  <%= @email.email_status.upcase %>
                </span>
              <% end %>
            </div>
          </div>
        </div>
    </header>

    <!-- Grid principal -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Main: corpo do email (2/3) -->
      <main class="lg:col-span-2 space-y-6">

        <section class="bg-white rounded-xl shadow-md ring-1 ring-slate-100 p-6">
          <h2 class="text-lg font-semibold text-slate-800 mb-4">Corpo do e-mail:</h2>
          <div class="prose max-w-none text-slate-700">
            <% if @email.body_html.present? %>
              <%= @email.body_html.html_safe %>
            <% else %>
              <div class="text-sm text-slate-400 bg-slate-50 p-4 rounded-md">Corpo do e-mail não disponível.</div>
            <% end %>
          </div>
        </section>

        <!-- COMMENTS box -->
        <section class="bg-white rounded-xl shadow-md ring-1 ring-slate-100 p-6">
          <h3 class="text-md font-semibold text-slate-800 mb-3">Comentários</h3>
          <div class="border-2 border-dashed border-slate-100 rounded-md p-6 text-sm text-slate-500 bg-slate-50">
            <p>Ainda não há a opção de comentários.</p>
          </div>
        </section>


      </main>


      <!-- Sidebar: metadados e ações rápidas -->
      <aside class="space-y-6">
        <!-- Quick info -->
        <div class="bg-white rounded-lg shadow ring-1 ring-slate-100 p-5">
          <h5 class="text-sm font-semibold text-slate-700 mb-3">Detalhes</h5>

          <dl class="text-sm text-slate-600 space-y-3">
            <div class="flex justify-between">
              <dt class="text-xs text-slate-400">De</dt>
              <dd class="text-right"><%= @email.sender_name %> (<%= @email.from_email || "—" %>)</dd>
            </div>

            <div class="flex justify-between">
              <dt class="text-xs text-slate-400">Para</dt>
              <dd class="text-right"><%= @email.recipient_name %> (<%= @email.to_email || "—" %>)</dd>
            </div>

            <div class="flex justify-between">
              <dt class="text-xs text-slate-400">Enviado</dt>
              <dd class="text-right"><%= @email.timestamp.present? ? l(@email.timestamp, format: :short) : '—' %></dd>
            </div>

            <div class="flex justify-between">
              <dt class="text-xs text-slate-400">Status</dt>
              <dd class="text-right"><%= @email.email_status.presence || '—' %></dd>
            </div>

            <div class="flex justify-between">
              <dt class="text-xs text-slate-400">Direção</dt>
              <dd class="text-right"><%= @email.email_direction.presence || '—' %></dd>
            </div>

            <div class="flex justify-between">
              <dt class="text-xs text-slate-400">Onboarding</dt>
              <dd class="text-right">
                <% if @email.onboarding %>
                  <%= link_to truncate(@email.onboarding.title, length: 30), onboarding_path(@email.onboarding), class: "text-sm text-blue-600" %>
                <% else %>
                  —
                <% end %>
              </dd>
            </div>
          </dl>
        </div>
      </aside>
    </div>
  </div>
</div>