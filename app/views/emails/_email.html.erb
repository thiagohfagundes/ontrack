<%# expects local: email %>
<div class="bg-white rounded-lg p-4 shadow-sm ring-1 ring-slate-100">
  <div class="flex items-start gap-3">
    <div class="flex-shrink-0 mt-0.5">
      <%= email_svg_icon(classes: "w-5 h-5 text-slate-500") %>
    </div>

    <div class="min-w-0 flex-1">
      <div class="flex items-start justify-between gap-3">
        <div class="min-w-0">
          <h3 class="text-sm font-semibold text-slate-800 truncate"><%= email.subject.presence || '(sem assunto)' %></h3>
          <p class="text-xs text-slate-500 mt-1 truncate"><%= email.body_text.present? ? email.body_text.truncate(160) : (email.from_email + " → " + (email.to_email || '—')) %></p>
        </div>

        <div class="text-right text-xs text-slate-400">
          <div><%= email.timestamp.present? ? email.timestamp.strftime("%d/%m %H:%M") : '—' %></div>
          <div class="mt-1"><%= email.email_direction.presence || email.email_status.presence || '—' %></div>
        </div>
      </div>

      <dl class="mt-3 grid grid-cols-2 gap-x-4 gap-y-2 text-xs text-slate-500">
        <div>
          <dt class="uppercase tracking-wide">De</dt>
          <dd class="mt-0.5 truncate"><%= email.from_email.presence || '—' %></dd>
        </div>
        <div>
          <dt class="uppercase tracking-wide">Para</dt>
          <dd class="mt-0.5 truncate"><%= email.to_email.presence || '—' %></dd>
        </div>
      </dl>

      <div class="mt-3 flex items-center justify-between">
        <div class="text-xs text-slate-500">
          <%= email.created_at.strftime("%d/%m/%Y") %>
        </div>

        <div class="flex items-center gap-2">
          <%= link_to "Abrir", onboarding_email_path(email.onboarding, email), class: "text-xs text-blue-600 hover:underline" %>
        </div>
      </div>
    </div>
  </div>
</div>
